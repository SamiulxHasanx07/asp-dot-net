@using Helpers
@model IEnumerable<Models.Product>
@{
    ViewData["Title"] = "Mango Shop";
}

@{
    var cart = Context.Session.GetObjectFromJson<Models.Cart>("Cart") ?? new Models.Cart();
    var cartCount = cart.Items.Sum(i => i.Quantity);
    var user = Context.Session.GetString("User");
}

<section class="hero-banner mb-5">
    <div class="p-5 text-center bg-warning rounded-3 shadow"
        style="background: linear-gradient(90deg, #ffe066 60%, #fffbe6 100%);">
        <img src="https://cdn.pixabay.com/photo/2016/03/05/19/02/mango-1238248_1280.jpg" alt="Mangoes" class="mb-3"
            style="max-width:180px; border-radius:1rem; box-shadow:0 2px 12px rgba(0,0,0,0.08);" />
        <h1 class="display-4 fw-bold mb-2">Welcome to Mango Shop!</h1>
        <p class="lead mb-3">Buy the freshest, juiciest mangoes online. Fast delivery, best prices!</p>
        <a href="#products" class="btn btn-lg btn-success shadow">Shop Now</a>
    </div>
</section>
<div class="container">


    <div class="row justify-content-center">
        @foreach (var product in Model)
        {
            <div class="col-md-4 mb-4">
                <div class="card h-100 shadow-sm">
                    <img src="@product.ImageUrl" class="card-img-top" alt="@product.Name"
                        style="height:220px;object-fit:cover;background:#f8f9fa;">
                    <div class="card-body d-flex flex-column">
                        <h5 class="card-title">@product.Name</h5>
                        <p class="card-text">@product.Description</p>
                        <p class="card-text mb-2"><strong>Price:</strong> $@product.Price</p>
                        <form method="post" action="/Home/AddToCart" class="mt-auto">
                            <input type="hidden" name="id" value="@product.Id" />
                            <button type="submit" class="btn btn-warning w-100">Add to Cart</button>
                        </form>
                    </div>
                </div>
            </div>
        }
    </div>

</div>


@if (TempData["Message"] != null)
{
    <script>
        window.addEventListener('DOMContentLoaded', function () {
            Swal.fire({
                icon: 'success',
                title: 'Added to Cart',
                text: '@TempData["Message"]',
                confirmButtonColor: '#ffc107',
                timer: 2000
            });
        });
    </script>
}
